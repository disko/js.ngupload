angular.module("ngUpload",[]).factory("upload",function(c,a){var b=function(){var e=c.document.createElement("iframe");e.setAttribute("id","upload_iframe");e.setAttribute("name","upload_iframe");e.setAttribute("width","0");e.setAttribute("height","0");e.setAttribute("border","0");e.setAttribute("style","width: 0; height: 0; border: none;");return e};var d=function(e){e.setAttribute("target","upload_iframe");e.setAttribute("method","post");e.setAttribute("enctype","multipart/form-data");e.setAttribute("encoding","multipart/form-data")};return{submit:function(h,i){var g=c.document.getElementById(h);var f=b();g.parentNode.appendChild(f);c.frames.upload_iframe.name="upload_iframe";iframeId=c.document.getElementById("upload_iframe");var e=function(){if(iframeId.detachEvent){iframeId.detachEvent("onload",e)}else{iframeId.removeEventListener("load",e,false)}if(iframeId.contentDocument){content=iframeId.contentDocument.body.innerHTML}else{if(iframeId.contentWindow){content=iframeId.contentWindow.document.body.innerHTML}else{if(iframeId.document){content=iframeId.document.body.innerHTML}}}a.$apply(i(content));setTimeout("iframeId.parentNode.removeChild(iframeId)",250)};if(iframeId.addEventListener){iframeId.addEventListener("load",e,true)}if(iframeId.attachEvent){iframeId.attachEvent("onload",e)}d(g);g.submit()}}});